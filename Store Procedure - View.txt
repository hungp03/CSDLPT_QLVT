*****View lấy danh sách phân mảnh*****
CREATE VIEW [dbo].[V_DS_PHANMANH]
AS

SELECT  TENCN=PUBS.description, TENSERVER= subscriber_server
   FROM dbo.sysmergepublications PUBS,  dbo.sysmergesubscriptions SUBS
   WHERE PUBS.pubid= SUBS.PUBID  AND PUBS.publisher <> SUBS.subscriber_server
   AND PUBS.description <> N'TRA CỨU'
GO


*****SP lấy thông tin user khi đăng nhập******
CREATE PROC [dbo].[SP_LaythongtinNV]
	@TENLOGIN NVARCHAR( 100)
AS
	DECLARE @UID INT
	DECLARE @MANV NVARCHAR(100)
	SELECT @UID= uid , @MANV= NAME FROM sys.sysusers 
  	WHERE sid = SUSER_SID(@TENLOGIN)

	SELECT  MANV= @MANV, 
       		HOTEN = (SELECT HO+ ' '+TEN FROM dbo.NHANVIEN WHERE MANV=@MANV ), 
       		TENNHOM=NAME
  	FROM sys.sysusers
    	WHERE UID = (SELECT groupuid FROM sys.sysmembers WHERE memberuid=@uid)


*****SP kiểm tra nhân viên đã tồn tại chưa*****
CREATE PROC SP_TracuuNV
    @MANHANVIEN INT
AS
BEGIN
    DECLARE @Result INT;

    IF EXISTS (SELECT MANV FROM LINK2.QLVT_DATHANG.DBO.NHANVIEN AS NV WHERE NV.MANV = @MANHANVIEN)
        SET @Result = 1;
    ELSE
        SET @Result = 0;

    RETURN @Result;
END;


LINK2 là link từ site phân mảnh tới site tra cứu
Trả về kết quả:
declare @res int
exec @res = SP_TracuuNV '1'
select @res

